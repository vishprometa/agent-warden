# Default values for AgentWarden Helm chart.

# -- Number of replicas. AgentWarden uses SQLite, so only 1 replica is supported
# unless you switch to an external database.
replicaCount: 1

image:
  # -- Container image repository
  repository: ghcr.io/agentwarden/agentwarden
  # -- Image pull policy
  pullPolicy: IfNotPresent
  # -- Overrides the image tag (defaults to the chart appVersion)
  tag: ""

# -- Image pull secrets for private registries
imagePullSecrets: []

# -- Override the release name
nameOverride: ""
# -- Override the full release name
fullnameOverride: ""

serviceAccount:
  # -- Create a ServiceAccount
  create: true
  # -- Annotations for the ServiceAccount
  annotations: {}
  # -- Name of the ServiceAccount (auto-generated if empty)
  name: ""

# -- Pod-level annotations
podAnnotations: {}

# -- Pod-level security context
podSecurityContext:
  fsGroup: 1000

# -- Container-level security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  readOnlyRootFilesystem: false

service:
  # -- Service type
  type: ClusterIP
  # -- Service port
  port: 6777

ingress:
  # -- Enable ingress
  enabled: false
  # -- Ingress class name
  className: ""
  # -- Ingress annotations
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: agentwarden.local
      paths:
        - path: /
          pathType: Prefix
  # -- TLS configuration
  tls: []
  #  - secretName: agentwarden-tls
  #    hosts:
  #      - agentwarden.local

# -- Resource requests and limits
resources: {}
  # requests:
  #   cpu: 100m
  #   memory: 128Mi
  # limits:
  #   cpu: 500m
  #   memory: 256Mi

# -- Node selector
nodeSelector: {}

# -- Tolerations
tolerations: []

# -- Affinity rules
affinity: {}

persistence:
  # -- Enable persistent storage for the SQLite database
  enabled: true
  # -- Storage class (empty uses the cluster default)
  storageClass: ""
  # -- Access mode
  accessMode: ReadWriteOnce
  # -- Volume size
  size: 1Gi
  # -- Annotations for the PVC
  annotations: {}

# -- AgentWarden configuration (rendered into a ConfigMap).
# This is the content of agentwarden.yaml. All fields from the
# configuration reference are supported.
config:
  server:
    port: 6777
    dashboard: true
    log_level: info
    cors: false

  upstream:
    default: https://api.openai.com/v1
    providers:
      openai: https://api.openai.com/v1
      anthropic: https://api.anthropic.com/v1
      gemini: https://generativelanguage.googleapis.com/v1beta
    passthrough_auth: true
    timeout: 120s
    retries: 2

  storage:
    driver: sqlite
    path: /data/agentwarden.db
    retention: 720h

  policies: []
    # - name: session-budget
    #   condition: "session.cost > 10.00"
    #   effect: terminate
    #   message: "Session killed: exceeded $10 budget"
    #
    # - name: block-shell-exec
    #   condition: 'action.type == "tool.call" && action.name == "shell_exec"'
    #   effect: deny
    #   message: "Shell execution is not allowed"

  detection:
    loop:
      enabled: true
      threshold: 5
      window: 60s
      action: pause
    cost_anomaly:
      enabled: true
      multiplier: 10
      action: alert
    spiral:
      enabled: true
      similarity_threshold: 0.9
      window: 5
      action: alert

  alerts:
    slack:
      webhook_url: ""
      channel: ""
    webhook:
      url: ""
      secret: ""

  evolution:
    enabled: false

# -- Extra environment variables for the container
extraEnv: []
  # - name: SLACK_WEBHOOK_URL
  #   valueFrom:
  #     secretKeyRef:
  #       name: agentwarden-secrets
  #       key: slack-webhook-url

# -- Extra volume mounts for the container
extraVolumeMounts: []

# -- Extra volumes for the pod
extraVolumes: []
